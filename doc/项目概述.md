# YouDub-webui 项目概述

## 项目简介
YouDub-webui 是一个自动化的视频翻译和配音工具，支持从 YouTube 下载视频，自动分离音频，进行语音识别，翻译文本，生成中文配音，并合成最终视频。

## 主要功能

1. **视频下载**：从 YouTube 下载视频，支持批量下载和指定分辨率
2. **音频分离**：分离视频中的人声和伴奏
3. **语音识别**：使用 WhisperX 进行高精度语音识别和说话人分离
4. **字幕翻译**：使用 AI 模型将识别的文本翻译成中文
5. **语音合成**：使用 VoxCPM 等模型生成中文配音
6. **视频合成**：将原始视频、中文配音和字幕合成为最终视频
7. **说话人克隆**：支持提取说话人语音特征进行语音克隆

## 核心模块

### 1. 视频下载器 (step000_video_downloader_csv.py)
- 支持从 CSV、JSON、TXT 文件批量导入 URL
- 自动生成文件夹名称：videos/上传者/上传日期 标题/
- 支持多种下载模式：all, video, audio, merge, separate

### 2. 音频分离器 (step010_demucs_vr.py)
- 使用 Demucs 模型分离人声和伴奏
- 支持从视频中提取音频
- 支持批量处理多个视频

### 3. 语音识别器 (step020_whisperx_silero_vad.py)
- 使用 WhisperX 进行高精度语音识别
- 支持说话人分离 (Diarization)
- 使用 Silero VAD 校准真实语音时长
- 支持智能句子合并

### 4. 翻译器 (step030_translation_vad_qwen.py)
- 使用 Qwen2.5 模型进行翻译
- 支持自动提取和应用术语表
- 支持多轮校对和质量检查
- 支持领域检测和专业术语翻译

### 5. 说话人克隆音频提取 (step031_extract_speaker_clips.py)
- 为每个说话人提取干净的语音片段
- 用于后续的 TTS 语音克隆

### 6. 语音合成器 (step040_tts_vox_cpm_qwen.py)
- 使用 VoxCPM 模型生成中文配音
- 支持全局语音克隆
- 支持音色一致性检查
- 自动调整音频长度以匹配原始视频

### 7. 视频合成器 (step050_synthesize_video.py)
- 将原始视频、合成语音和字幕合成为最终视频
- 支持字幕嵌入和样式自定义
- 支持播放速度调整
- 支持分辨率适配

## 工作流程

1. **视频下载**：从 YouTube 下载视频到指定目录
2. **音频提取**：从视频中提取音频文件
3. **音频分离**：分离人声和伴奏
4. **语音识别**：识别音频中的文字内容
5. **文本翻译**：将识别的文字翻译成中文
6. **说话人克隆**：提取说话人语音特征
7. **语音合成**：生成中文配音
8. **视频合成**：将视频、配音和字幕合成为最终视频

## 使用方法

### 单个模块使用
```bash
# 下载视频
python step000_video_downloader_csv.py tasks.csv

# 分离音频
python step010_demucs_vr.py --root videos

# 语音识别
python step020_whisperx_silero_vad.py --root videos

# 翻译文本
python step030_translation_vad_qwen.py --root videos

# 提取说话人克隆音频
python step031_extract_speaker_clips.py --folder videos/xxx

# 语音合成
python step040_tts_vox_cpm_qwen.py --root videos

# 视频合成
python step050_synthesize_video.py --root videos
```

### 全流程自动化
```bash
# 使用 do_everything.py 作为入口点
python do_everything.py --url "https://www.youtube.com/watch?v=xxx" --root videos
python do_everything.py  # 处理 tasks.csv 中的所有视频
python do_everything.py --step 3  # 从第3步开始执行
```

## 配置文件

项目使用 `.env` 文件进行配置，主要配置项包括：

- `MODEL_NAME`：翻译模型名称
- `API_BASE`：API 地址
- `API_KEY`：API 密钥
- `VOXCPM_MODEL_PATH`：VoxCPM 模型路径

## 技术栈

- Python 3.7+
- yt-dlp：视频下载
- Demucs：音频分离
- WhisperX：语音识别
- Qwen2.5：文本翻译
- VoxCPM：语音合成
- FFmpeg：音频视频处理
- Loguru：日志记录

## 项目结构

```
YouDub-webui/
├── youdub/
│   ├── step000_video_downloader_csv.py
│   ├── step010_demucs_vr.py
│   ├── step020_whisperx_silero_vad.py
│   ├── step030_translation_vad_qwen.py
│   ├── step031_extract_speaker_clips.py
│   ├── step040_tts_vox_cpm_qwen.py
│   ├── step050_synthesize_video.py
│   ├── step060_genrate_info.py
│   ├── do_everything.py         # 唯一入口点，实现完整流程
│   └── ...
├── doc/
│   ├── 项目概述.md
│   ├── 系统架构文档.md
│   └── ...
├── .env
├── requirements.txt
└── README.md
```